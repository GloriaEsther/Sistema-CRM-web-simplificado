<h2>Editar oportunidad</h2>

<form method="POST">
    {% csrf_token %}

    <label>Nombre de la oportunidad:</label><br>
    <input type="text" name="nombreoportunidad" value="{{ oportunidad.nombreoportunidad }}" required>
    <br><br>

    <label>Valor estimado:</label><br>
    <input type="number" step="0.01" name="valor_estimado" value="{{ oportunidad.valor_estimado }}" required>
    <br><br>

    <label>Fecha de cierre estimada:</label><br>
    <input type="datetime-local"
           name="fecha_cierre_estimada"
           value="{{ oportunidad.fecha_cierre_estimada|date:'Y-m-d\\TH:i' }}"
           required>
    <br><br>

    <label>Comentarios:</label><br>
    <textarea name="comentarios">{{ oportunidad.comentarios }}</textarea>
    <br><br>

    <label>Cliente:</label><br>
    <select name="cliente_oportunidad">
        {% for c in clientes %}
            <option value="{{ c.idcliente }}"
                {% if c.idcliente == oportunidad.cliente_oportunidad.idcliente %}selected{% endif %}>
                {{ c.nombre }}
            </option>
        {% endfor %}
    </select>
    <br><br>

    <label>Etapa:</label><br>
    <select name="etapa_ventas">
        {% for e in etapas %}
            <option value="{{ e.idetapa_ventas }}"
                {% if e.idetapa_ventas == oportunidad.etapa_ventas.idetapa_ventas %}selected{% endif %}>
                {{ e.nombre_etapa }}
            </option>
        {% endfor %}
    </select>
    <br><br>

    <label>Usuario responsable:</label><br>
    <select name="usuario_responsable">
        {% for u in usuarios %}
            <option value="{{ u.idusuario }}"
                {% if u.idusuario == oportunidad.usuario_responsable.idusuario %}selected{% endif %}>
                {{ u.nombre }} {{ u.apellidopaterno }}
            </option>
        {% endfor %}
    </select>
    <br><br>

    <button type="submit">Guardar cambios</button>
    <a href="{% url 'oportunidades:listar' %}">Cancelar</a>
</form>